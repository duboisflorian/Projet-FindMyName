<html>
<head>

<script>
	function ecriture()
	{
		var loginArr=["Lionel","Florian","Yani","Maxime","Diego"];
		var mdpArr=["1234","1234","1234","1234","1234"];
		
		console.log(loginArr[2]);
		console.log(loginArr.length);
		
		//var login = document.getElementById("login").value;
		//var mdp = document.getElementById("mdp").value;
		
		var fileSystem=new ActiveXObject("Scripting.FileSystemObject");
		var monfichier=fileSystem.OpenTextFile("connexion.json", 2 ,true);
		monfichier.WriteLine("{");
		for (var i=0; i < loginArr.length;i++)
		{
			if (i<loginArr.length-1)
			{
				monfichier.WriteLine('"utilisateur'+i+'":');
				monfichier.WriteLine("{");
				monfichier.WriteLine('"login": "' +loginArr[i] +'",' );
				monfichier.WriteLine('"mdp": "' +mdpArr[i] +'"');
				monfichier.WriteLine("},");
			}
			else
			{
				monfichier.WriteLine('"utilisateur'+i+'":');
				monfichier.WriteLine("{");
				monfichier.WriteLine('"login": "' +loginArr[i] +'",' );
				monfichier.WriteLine('"mdp": "' +mdpArr[i] +'"');
				monfichier.WriteLine("}");
			}
			
			
		}
		
		monfichier.WriteLine("}");
		
		//Creation du tableau qui va recevoir toutes les lignes du fichier JSON
		
		var Tab = new Array();
		
		monfichier=fileSystem.OpenTextFile("tutorielsenfolie.txt", 1 ,true);
		while (!monfichier.AtEndOfStream)
		{	
			var ligne = monfichier.ReadLine();
			// Agrandissement du tableau
			Tab.push(ligne);
			alert(ligne);
			
		}
		
		// Lecture du tableau Tab 
		
		for (var i = 0; i < Tab.length; i++)
		{
			document.write(Tab[i]);
		}
		
		//var affiche = monfichier.Read(10);
		//alert(affiche); // imprime: "tutoriels en folie\n"
		//monFichier.Close();
	}
</script>
	
</head>


<body>
	<input type="text" id="login" />
	<input type="text" id="mdp" />	
	<input type="button" value="Ajouter" onclick="ecriture()"/>
</body>

</html>