<html>
<meta charset="UTF-8">

<head>

<script>
	function ecriture()
	{
		
		//Creation du tableau qui va recevoir toutes les lignes du fichier JSON
		
		var Tab = new Array();
		var fileSystem=new ActiveXObject("Scripting.FileSystemObject");
		monfichier=fileSystem.OpenTextFile("connexion.json", 1 ,true);
		while (!monfichier.AtEndOfStream)
		{	
			var ligne = monfichier.ReadLine();
			// Agrandissement du tableau
			Tab.push(ligne);
			//alert(ligne);
			
		}
		
		
		//Recup des données à ajouter
		var login = document.getElementById("login").value;
		var mdp = document.getElementById("mdp").value;
		
		//Substring
		
		var Extract = Tab[Tab.length-6].substring(12,13);
		var nbExtract = parseInt(Extract);
		nbExtract = nbExtract+1;
		//alert(nbExtract);
		
		Tab.splice(Tab.length-1,1,'"utilisateur'+nbExtract+'":');
		Tab.push('{');
		Tab.push('"login": "'+login+'",');
		Tab.push('"mdp": "' +mdp +'"');
		Tab.push('}');
		Tab.push('}');
		
		
		// Enlève la virgule du dernier objet 
		
		Tab.splice(Tab.length-7,1,'},');
		
		// Lecture du tableau Tab 
		
		for (var i = 0; i < Tab.length; i++)
		{
			document.write(Tab[i]+ "<BR/>");
			
		}
			
		
				
		//var loginArr=["Lionel","Florian","Yani","Maxime","Diego"];
		//var mdpArr=["1234","1234","1234","1234","1234"];
		
		//console.log(loginArr[2]);
		//console.log(loginArr.length);
		
				
		
		var monfichier=fileSystem.OpenTextFile("connexion.json", 2 ,true);
		for (var i=0; i < Tab.length;i++)
		{
			monfichier.WriteLine(Tab[i]);
		}		
		
		//var affiche = monfichier.Read(10);
		//alert(affiche); // imprime: "tutoriels en folie\n"
		//monFichier.Close();
	}
</script>
	
</head>


<body>
	<input type="text" id="login" placeholder="entrer le login à ajouter"/> <br/>
	<input type="text" id="mdp" placeholder="entrer le mdp à ajouter"/>	<br/>
	<input type="button" value="Ajouter" onclick="ecriture()"/>
</body>

</html>